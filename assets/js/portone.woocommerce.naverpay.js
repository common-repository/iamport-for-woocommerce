jQuery(function(u){var a=u("form.cart"),a=(0<a.length&&(IMP.init(iamport_naverpay.user_code),a.each(function(){var a,r=u(this);r.is(".variations_form")?(a=r.data("product_variations"),t(r,a)):t(r)})),u("form.woocommerce-cart-form"));function r(){var r,a=u("#iamport-naverpay-cart-button[naverpay-button-attached!=yes]");0<a.length&&(a.attr("naverpay-button-attached","yes"),r=a.is(".enabled"),naver.NaverPayButton.apply({BUTTON_KEY:iamport_naverpay.button_key,TYPE:iamport_naverpay.button_type||"C",COLOR:iamport_naverpay.button_color||1,COUNT:1,ENABLE:r?"Y":"N",EMBED_ID:"iamport-naverpay-cart-button",BUY_BUTTON_HANDLER:function(a){if(!r)return alert("네이버페이로 구매가 불가능한 상품이 포함되어있습니다.");u.ajax({type:"GET",url:iamport_naverpay.ajax_info_url,data:{action:"iamport_naver_carts"},dataType:"json",dataFilter:function(a){var r=a.match(/{(.*)}/);return r?r[0]:a},success:function(a){if(a.error)return alert(a.error);var r={pg:"naverco",amount:a.amount,name:a.name,merchant_uid:a.merchant_uid,naverProducts:a.naverProducts,naverInterface:a.naverInterface,naverCultureBenefit:a.naverCultureBenefit,notice_url:a.notice_url};a.pg_id&&(r.pg="naverco."+a.pg_id),IMP.request_pay(r,function(a){if(!a.success)return alert(a.error_msg)})}})}}))}function t(t,e){for(var a=u(".iamport-naverpay-product-button[naverpay-button-attached!=yes]"),r=0;r<a.length;r++){var n=u(a[r]),o=(n.attr("naverpay-button-attached","yes"),n.is(".enabled"));naver.NaverPayButton.apply({BUTTON_KEY:iamport_naverpay.button_key,TYPE:iamport_naverpay.button_type||"C",COLOR:iamport_naverpay.button_color||1,COUNT:2,ENABLE:o?"Y":"N",EMBED_ID:n.attr("id"),BUY_BUTTON_HANDLER:function(a){var r;return o?0<t.find(".single_add_to_cart_button.disabled").length?e?alert("상품 옵션을 선택해주세요."):alert("구매할 수 없는 상품입니다."):void u.ajax({type:"POST",url:iamport_naverpay.ajax_info_url,data:("action=iamport_naver_info&"+(r=t).serialize()+"&product-id="+r.find("[name='add-to-cart']").val()).replace(/&add-to-cart=[0-9]+/i,""),dataType:"json",dataFilter:function(a){var r=a.match(/{(.*)}/);return r?r[0]:a},success:function(a){if(a.error)return alert(a.error);var r={pg:"naverco",amount:a.amount,name:a.name,merchant_uid:a.merchant_uid,naverProducts:a.naverProducts,naverInterface:a.naverInterface,naverCultureBenefit:a.naverCultureBenefit,notice_url:a.notice_url};a.pg_id&&(r.pg="naverco."+a.pg_id),IMP.request_pay(r,function(a){if(!a.success)return alert(a.error_msg)})}}):alert("네이버페이로 구매가 불가능한 상품입니다.")},WISHLIST_BUTTON_HANDLER:function(a){var r=[];r.push(e?{product:u('input[name="product_id"]').val()}:{product:u('[name="add-to-cart"]').val()}),u.ajax({type:"GET",url:iamport_naverpay.ajax_info_url,data:{action:"iamport_naver_zzim_info",products:r},dataType:"json",dataFilter:function(a){var r=a.match(/{(.*)}/);return r?r[0]:a},success:function(a){for(var r=a.naverProducts.length-1;0<=r;r--)a.naverProducts[r].url=encodeURI(a.naverProducts[r].url),a.naverProducts[r].image=encodeURI(a.naverProducts[r].image);var t={naverProducts:a.naverProducts};a.pg_id&&(t.pg="naverco."+a.pg_id),IMP.naver_zzim(t)}})}})}}(0<a.length||window.wc_add_to_cart_params&&1==window.wc_add_to_cart_params.is_cart)&&(IMP.init(iamport_naverpay.user_code),u(document.body).on("updated_wc_div",function(){r()}),r())});